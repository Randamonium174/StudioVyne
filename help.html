<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>StudioVyne — Help</title>

<!-- Fonts + GSAP -->
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@700;800&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

<style>
:root{
  --max:1320px;
  --nav-h:72px;
  --accent: linear-gradient(135deg,#ff66c1,#ff9ab0 40%,#ffd18c 80%);
  --glass: rgba(255,255,255,0.04);
}

/* Reset */
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;scroll-behavior:smooth}
html{
  overflow-x:hidden;
  max-width:100%;
  -webkit-text-size-adjust:100%;
}

/* FULL PAGE BACKGROUND */
body{
  font-family:Inter, sans-serif;
  color:#fff;
  -webkit-font-smoothing:antialiased;
  overflow-x:hidden;

  background-color:#000;
  background-image:url("https://images.unsplash.com/photo-1716326386093-d80fa73692a6?q=80&w=1740&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");
  background-position:center;
  background-size:cover;
  background-repeat:no-repeat;
  background-attachment:fixed;
}

/* MOBILE BG OVERRIDE */
@media (max-width:780px){
  body{
    background-image:url("https://images.unsplash.com/photo-1668624384628-38c90f9e5783?q=80&w=654&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");
    background-attachment:scroll !important; /* critical for performance */
  }
}

/* NAV (wrap is relative so dropdown can position under nav) */
.nav-wrap{
  position:fixed;
  top:18px;
  left:0;
  right:0;
  display:flex;
  justify-content:center;
  z-index:1200;
}
.nav{
  width:94%;
  max-width:var(--max);
  height:var(--nav-h);
  background:rgba(0,0,0,0.55);
  backdrop-filter:blur(14px);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 26px;
  border-radius:16px;
  box-shadow:0 20px 60px rgba(0,0,0,0.75);
  position:relative;
}
.brand-wrap{display:flex;align-items:center;gap:12px}
.brand-logo{width:48px;height:48px;border-radius:50%;object-fit:cover}
.brand{
  font-family:'Space Grotesk';
  font-weight:800;
  background:var(--accent);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  font-size:1.1rem;
}

/* Desktop nav links */
nav.primary{display:flex;gap:34px;align-items:center}
nav.primary a{
  font-family:'Space Grotesk';
  font-weight:700;
  color:white;
  text-decoration:none;
  position:relative;
  padding:4px;
  transition:transform .2s ease;
}
nav.primary a:hover{transform:translateY(-2px)}
nav.primary a::after{
  content:"";
  position:absolute;
  bottom:-6px;
  left:0;
  height:3px;
  width:0;
  border-radius:4px;
  background:linear-gradient(90deg,#ff66c1,#ffd18c);
  transition:width .3s;
}
nav.primary a:hover::after{width:100%}

/* Hamburger — 2 line */
.menu-btn{
  width:26px;
  height:16px;
  display:none;
  flex-direction:column;
  justify-content:space-between;
  cursor:pointer;
}
.menu-line{
  height:3px;
  width:100%;
  background:white;
  border-radius:6px;
  transition:transform .28s cubic-bezier(.22,.9,.28,1);
}
.menu-btn.active .menu-line:nth-child(1){transform:translateY(6px) rotate(45deg)}
.menu-btn.active .menu-line:nth-child(2){transform:translateY(-6px) rotate(-45deg)}

/* Simple dropdown under nav (hidden by default) */
.nav-dropdown{
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  top:calc(var(--nav-h) + 12px);
  width:calc(100% - 56px);
  max-width:960px;
  background:linear-gradient(180deg,rgba(0,0,0,0.85),rgba(0,0,0,0.8));
  border-radius:14px;
  padding:18px 22px;
  box-shadow:0 30px 80px rgba(0,0,0,0.85);
  border:1px solid rgba(255,255,255,0.12);
  display:none;
  z-index:1300;
  backdrop-filter:blur(10px);
  text-align:center;
}
.nav-dropdown .nav-links{
  display:flex;
  flex-direction:column;
  gap:14px;
  align-items:center;
}
.nav-dropdown .nav-links a{
  font-family:'Space Grotesk';
  font-weight:800;
  color:white;
  text-decoration:none;
  font-size:1.05rem;
  letter-spacing:1px;
}

/* MAIN */
main{padding-top:calc(var(--nav-h) + 40px)}

/* HERO – no banner bg, just content on top of page bg */
.hero{
  min-height:80vh;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
  text-align:center;
}
.hero-inner{position:relative;z-index:2;max-width:920px;padding:0 20px}
.hero h1{
  font-family:'Space Grotesk';
  font-weight:800;
  font-size:clamp(2.4rem,5vw,3.6rem);
  background:var(--accent);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.hero p{
  font-size:1.1rem;
  margin-top:14px;
}

/* SECTIONS */
.section{
  max-width:var(--max);
  margin:0 auto;
  padding:92px 20px;
  text-align:center;
}
.title{
  font-family:'Space Grotesk';
  font-weight:800;
  font-size:2.5rem;
  background:var(--accent);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  margin-bottom:10px;
  opacity:0;
  transform:translateY(30px);
}
.desc{
  max-width:760px;
  margin:0 auto 40px;
  font-size:1.05rem;
  line-height:1.75;
  opacity:0;
  transform:translateY(20px);
}

/* CARDS (desktop grid) */
.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:28px;
}

/* UPDATED GLASSY BLACK CARDS */
.card{
  background:rgba(0,0,0,0.45);
  backdrop-filter:blur(12px);
  border-radius:18px;
  overflow:hidden;
  border:1px solid rgba(255,255,255,0.14);
  box-shadow:0 20px 60px rgba(0,0,0,0.85);
  opacity:0;
  transform:translateY(30px);
}

/* UPDATED DARK GLASS MEDIA BACKGROUND */
.media{
  width:100%;
  aspect-ratio:16/10;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,0.55);
  overflow:hidden;
}

.media img{
  width:100%;
  height:100%;
  object-fit:cover;
  transition:transform 1s ease;
}
.card:hover .media img{transform:scale(1.06)}

.body{padding:22px 22px 26px}
.title-sub{
  font-family:'Space Grotesk';
  font-weight:800;
  font-size:1.15rem;
  background:var(--accent);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  margin-bottom:10px;
}
.kicker{
  font-size:.98rem;
  line-height:1.8;
  opacity:.96;
}

/* MOBILE */
@media (max-width:780px){
  nav.primary{display:none}
  .menu-btn{display:flex}

  .hero{
    min-height:70vh;
  }

  .section{
    padding:72px 18px;
  }

  /* 3D STACKED SWIPE LAYOUT FOR CARDS */
  .cards{
    position:relative;
    max-width:100%;
    padding:38px 0 18px;
    perspective:1200px;
    display:block; /* override grid on mobile */
    touch-action:pan-y; /* allow vertical scroll, block horizontal pan */
  }

  .card{
    position:absolute;
    left:50%;
    top:0;
    width:86%;
    max-width:360px;
    min-width:0;
    margin:0;
    border-radius:16px;
    transform:none;
    opacity:1; /* JS + layout control */
    transform-origin:center center;
    transform-style:preserve-3d;
    transition:opacity .3s ease; /* transforms handled by GSAP for smoother swipe */
  }

  .media{
    height:220px;
    aspect-ratio:auto;
    padding:0;
    background:rgba(0,0,0,0.55);
  }

  .media img{
    width:100%;
    height:100%;
    object-fit:cover;
    border-radius:14px;
  }

  .body{padding:16px 16px 22px}
  .title-sub{font-size:1.05rem}
  .kicker{font-size:.95rem}

  .nav-dropdown{
    width:calc(100% - 40px);
    left:50%;
    transform:translateX(-50%);
    top:calc(var(--nav-h) + 12px);
  }
}

/* FOOTER */
.sep{
  height:2px;
  max-width:var(--max);
  margin:60px auto;
  background:linear-gradient(90deg,#0000,#ff66c1 20%,#ffd18c 80%,#0000);
  opacity:.14;
}
footer{
  padding:40px 20px;
  text-align:center;
  color:rgba(255,255,255,0.9);
  text-shadow:0 0 8px rgba(0,0,0,0.65);
}

/* --- MOBILE FIX FOR GRADIENT TEXT RENDER & DELAY --- */
@media (max-width:780px){

  /* make sure all key text is visible immediately */
  .hero h1,
  .hero p,
  .title,
  .desc,
  .title-sub{
    opacity:1 !important;
    transform:none !important;
  }

  /* ensure gradient clip renders on iOS, but keep gradient */
  .hero h1,
  .title,
  .title-sub{
    -webkit-text-fill-color:transparent !important;
    -webkit-background-clip:text !important;
    background-clip:text !important;
  }

  /* help Safari with heavy compositing */
  body{
    -webkit-backface-visibility:hidden;
    backface-visibility:hidden;
  }
}
</style>
</head>

<body>

<!-- NAV -->
<div class="nav-wrap">
  <header class="nav" id="mainNav">
    <div class="brand-wrap">
      <img src="studiologo.png" alt="StudioVyne logo" class="brand-logo">
      <div class="brand">StudioVyne</div>
    </div>

    <nav class="primary">
      <a href="index.html">HOME</a>
      <a href="service.html">SERVICES</a>
      <a href="contact.html">CONTACT</a>
    </nav>

    <div class="menu-btn" id="hamburger" aria-label="Open menu" role="button" tabindex="0">
      <div class="menu-line"></div>
      <div class="menu-line"></div>
    </div>

    <div class="nav-dropdown" id="navDropdown" aria-hidden="true" role="menu">
      <div class="nav-links">
        <a href="index.html" class="drop-link">HOME</a>
        <a href="service.html" class="drop-link">SERVICES</a>
        <a href="contact.html" class="drop-link">CONTACT</a>
      </div>
    </div>
  </header>
</div>

<main>

<!-- HERO -->
<section class="hero">
  <div class="hero-inner">
    <h1>How We Help You Build Better Stories</h1>
    <p>StudioVyne’s creative framework — built for clarity, connection, and conversion.</p>
  </div>
</section>

<!-- OUR APPROACH -->
<section class="section">
  <div class="title">Our Approach</div>
  <div class="desc">We combine discovery, strategy, and execution — producing work that is thoughtful, purposeful, and made to last.</div>

  <div class="cards">
    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://plus.unsplash.com/premium_photo-1757553358799-900b78f19844?auto=format&fit=crop&w=1740&q=80" alt="Discovery & Research">
      </div>
      <div class="body">
        <div class="title-sub">Discovery & Research</div>
        <div class="kicker">
          We map your audience, competitors and current touchpoints so we know exactly where attention is leaking and where the real opportunities sit. This becomes a clear foundation before any pixels or words are created.
        </div>
      </div>
    </article>

    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://images.unsplash.com/photo-1758873272414-c0bf30332738?auto=format&fit=crop&w=2064&q=80" alt="Creative Strategy">
      </div>
      <div class="body">
        <div class="title-sub">Creative Strategy</div>
        <div class="kicker">
          We turn research into a simple story: who you are, what you stand for, and how that shows up visually. Every layout, motion idea and line of copy is tied back to a strategic direction instead of random aesthetics.
        </div>
      </div>
    </article>

    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://images.unsplash.com/photo-1521737604893-d14cc237f11d?auto=format&fit=crop&w=1400&q=80" alt="Execution Excellence">
      </div>
      <div class="body">
        <div class="title-sub">Execution Excellence</div>
        <div class="kicker">
          From typography and grids to motion timings and export settings, we obsess over the details. The result is work that feels sharp, stable and ready to live across your launch campaigns and future phases.
        </div>
      </div>
    </article>
  </div>
</section>

<div class="sep"></div>

<!-- WHAT WE BRING -->
<section class="section">
  <div class="title">What We Bring</div>
  <div class="desc">A mix of craft, clarity and motion — translated into systems, experiences and visuals that elevate your presence.</div>

  <div class="cards">
    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://images.unsplash.com/photo-1542744094-24638eff58bb?auto=format&fit=crop&w=1400&q=80" alt="Brand Identity">
      </div>
      <div class="body">
        <div class="title-sub">Brand Identity</div>
        <div class="kicker">
          We design visual identities that feel ownable: wordmarks, symbols, palettes and type systems that actually make sense for your story. So you don’t just look “nice” — you look like yourself at your best.
        </div>
      </div>
    </article>

    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://plus.unsplash.com/premium_photo-1663091696773-ae012087b421?auto=format&fit=crop&w=1740&q=80" alt="Digital Experience">
      </div>
      <div class="body">
        <div class="title-sub">Digital Experience</div>
        <div class="kicker">
          We think through how people actually move through your site or product. Clear flows, focused interactions and motion cues help them find what matters faster, with less friction and more confidence.
        </div>
      </div>
    </article>

    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?auto=format&fit=crop&w=1400&q=80" alt="Visual Design">
      </div>
      <div class="body">
        <div class="title-sub">Visual Design</div>
        <div class="kicker">
          We craft layouts, imagery and compositions that feel modern but still human. Every visual choice supports the message — from contrast and rhythm to how your work is showcased on different screens.
        </div>
      </div>
    </article>

    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://plus.unsplash.com/premium_photo-1723489254801-ebec5f249c05?auto=format&fit=crop&w=1160&q=80" alt="Motion & Storytelling">
      </div>
      <div class="body">
        <div class="title-sub">Motion & Storytelling</div>
        <div class="kicker">
          We use motion to guide attention and emotion — not just to add noise. Subtle transitions, loops and story beats help people understand who you are and remember how your brand made them feel.
        </div>
      </div>
    </article>
  </div>
</section>

<div class="sep"></div>

<!-- HOW IT IMPACTS YOU -->
<section class="section">
  <div class="title">How It Impacts You</div>
  <div class="desc">Even as a young studio, our work aims to create clarity, spark recognition, and build emotional connection — all focused on your future growth.</div>

  <div class="cards">
    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?auto=format&fit=crop&w=1400&q=80" alt="Engagement">
      </div>
      <div class="body">
        <div class="title-sub">Engagement</div>
        <div class="kicker">
          We design with attention in mind: bold hierarchy, considered motion and a clear path through the page. That means more people pause, interact and stay with your story for longer.
        </div>
      </div>
    </article>

    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://images.unsplash.com/photo-1706193589333-da530df63ecf?auto=format&fit=crop&w=1740&q=80" alt="Recognition">
      </div>
      <div class="body">
        <div class="title-sub">Recognition</div>
        <div class="kicker">
          When visuals, tone and motion stay consistent, people start recognising you faster. We build systems so your brand feels the same across website, socials, decks and campaigns.
        </div>
      </div>
    </article>

    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://plus.unsplash.com/premium_photo-1693166985133-8a849aa237de?auto=format&fit=crop&w=2064&q=80" alt="Emotional Impact">
      </div>
      <div class="body">
        <div class="title-sub">Emotional Impact</div>
        <div class="kicker">
          Good design isn’t just clear — it’s felt. We focus on the small emotional beats: how a headline lands, how a scroll sequence reveals work, and how motion reinforces the mood of your brand.
        </div>
      </div>
    </article>
  </div>
</section>

<div class="sep"></div>

<!-- THE VISION REALIZED -->
<section class="section">
  <div class="title">The Vision Realized</div>
  <div class="desc">In the end you get a coherent brand system, a visual language and digital experiences designed to perform and inspire.</div>

  <div class="cards">
    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://plus.unsplash.com/premium_photo-1672759362274-bb02b3645cb8?auto=format&fit=crop&w=1857&q=80" alt="Creative Launch">
      </div>
      <div class="body">
        <div class="title-sub">Creative Launch</div>
        <div class="kicker">
          We help you roll out your new identity with intent — from launch pages and hero visuals to announcement assets. So your audience experiences a clear “before and after” moment, not a quiet update.
        </div>
      </div>
    </article>

    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://images.unsplash.com/photo-1498050108023-c5249f4df085?auto=format&fit=crop&w=1400&q=80" alt="Digital Growth">
      </div>
      <div class="body">
        <div class="title-sub">Digital Growth</div>
        <div class="kicker">
          With better UX, clearer messaging and stronger visuals, your digital touchpoints become easier to find and easier to trust. Over time, this compounds into more leads, better clients and stronger momentum.
        </div>
      </div>
    </article>

    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://images.unsplash.com/photo-1563674881-8abcee2b556a?auto=format&fit=crop&w=1740&q=80" alt="Visual Legacy">
      </div>
      <div class="body">
        <div class="title-sub">Visual Legacy</div>
        <div class="kicker">
          We create systems you can actually reuse — not one-off designs that die after launch. Your team has a library of components, layouts and motion rules that can travel with you as you grow.
        </div>
      </div>
    </article>
  </div>
</section>

<div class="sep"></div>

<!-- OUR PACKAGES -->
<section class="section">
  <div class="title">Our Packages</div>
  <div class="desc">Four clear paths — from personalised kickstart to long-term partnership. Each package is tailored with practical deliverables and creative direction.</div>

  <div class="cards">
    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://plus.unsplash.com/premium_photo-1683133556035-403d392ef900?auto=format&fit=crop&w=1740&q=80" alt="Personalised">
      </div>
      <div class="body">
        <div class="title-sub">Personalised</div>
        <div class="kicker">
          A compact starter pack for founders who need a clear visual direction fast — including a core mark, colour story and basic layout rules to show up with more intent across socials and decks.
        </div>
      </div>
    </article>

    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://images.unsplash.com/photo-1542744095-291d1f67b221?auto=format&fit=crop&w=1400&q=80" alt="Curated">
      </div>
      <div class="body">
        <div class="title-sub">Curated</div>
        <div class="kicker">
          For teams ready to refine their presence: a tighter system of type, grids, imagery and key templates that keep your brand consistent across multiple channels without feeling repetitive.
        </div>
      </div>
    </article>

    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=1400&q=80" alt="Essence">
      </div>
      <div class="body">
        <div class="title-sub">Essence</div>
        <div class="kicker">
          A full identity system — including visual language, component library, motion guidelines and launch touchpoints — built to support bigger campaigns and multi-channel storytelling.
        </div>
      </div>
    </article>

    <article class="card">
      <div class="media">
        <img loading="lazy" src="https://images.unsplash.com/photo-1521737604893-d14cc237f11d?auto=format&fit=crop&w=1400&q=80" alt="Vyne Signature">
      </div>
      <div class="body">
        <div class="title-sub">Vyne Signature</div>
        <div class="kicker">
          A deeper, ongoing partnership where we act as your design and motion team — shaping campaigns, testing ideas and continuously refining how your brand shows up as you grow.
        </div>
      </div>
    </article>
  </div>
</section>

<footer>© 2025 StudioVyne — Crafted with care</footer>
</main>

<script>
/* GSAP + ScrollTrigger */
gsap.registerPlugin(ScrollTrigger);

const isMobile = window.innerWidth <= 780;

/* On mobile: show text immediately and skip GSAP text fade/slide */
if (isMobile) {
  // Force visibility + remove transforms for key text
  setTimeout(() => {
    document.querySelectorAll('.title, .title-sub, .hero h1, .hero p, .desc').forEach(el => {
      el.style.opacity = "1";
      el.style.transform = "none";
      // force repaint to avoid Safari delaying gradient text
      void el.offsetHeight;
    });
  }, 50);
}

/* Titles + desc animations (DESKTOP ONLY) */
if (!isMobile) {
  gsap.utils.toArray(".section").forEach(section=>{
    const t = section.querySelector(".title");
    const d = section.querySelector(".desc");
    if(!t || !d) return;
    gsap.timeline({
      scrollTrigger:{
        trigger:section,
        start:"top 80%",
        once:true
      }
    })
    .to(t,{y:0,opacity:1,duration:.7,ease:"power3.out"})
    .to(d,{y:0,opacity:1,duration:.7,ease:"power3.out"},"-=.45");
  });
}

/* Card entrance (DESKTOP ONLY) */
if(!isMobile){
  gsap.utils.toArray(".cards").forEach(container=>{
    gsap.fromTo(container.children,
      {opacity:0,y:32},
      {
        opacity:1,
        y:0,
        duration:0.9,
        ease:"power3.out",
        stagger:0.16,
        scrollTrigger:{
          trigger:container,
          start:"top 82%",
          once:true
        }
      }
    );
  });
}

/* Parallax image scale on larger screens */
gsap.utils.toArray(".media img").forEach(img=>{
  if(window.innerWidth > 780){
    gsap.fromTo(img,
      {scale:1.08},
      {
        scale:1,
        scrollTrigger:{
          trigger:img.closest(".card"),
          start:"top bottom",
          end:"bottom top",
          scrub:true
        }
      }
    );
  }
});

/* NAV DROPDOWN logic */
const ham = document.getElementById('hamburger');
const dropdown = document.getElementById('navDropdown');
let dropdownOpen = false;

function openDropdown(){
  dropdownOpen = true;
  ham.classList.add('active');
  dropdown.style.display = 'block';
  dropdown.setAttribute('aria-hidden','false');
  gsap.killTweensOf(dropdown);
  gsap.fromTo(dropdown,
    {y:-8, opacity:0},
    {y:0, opacity:1, duration:0.28, ease:'power2.out'}
  );
}

function closeDropdown(){
  dropdownOpen = false;
  ham.classList.remove('active');
  gsap.killTweensOf(dropdown);
  gsap.to(dropdown,
    {
      y:-8,
      opacity:0,
      duration:0.2,
      ease:'power2.in',
      onComplete: ()=>{
        dropdown.style.display = 'none';
        dropdown.setAttribute('aria-hidden','true');
      }
    }
  );
}

/* toggle on hamburger click */
ham.addEventListener('click', (e)=>{
  e.stopPropagation();
  dropdownOpen ? closeDropdown() : openDropdown();
});

/* close when clicking outside nav/dropdown */
document.addEventListener('click', (e)=>{
  const navEl = document.getElementById('mainNav');
  if(dropdownOpen && !navEl.contains(e.target)){
    closeDropdown();
  }
});

/* close on Escape */
document.addEventListener('keydown', (e)=>{
  if(e.key === 'Escape' && dropdownOpen) closeDropdown();
});

/* close when clicking a dropdown link */
document.querySelectorAll('.drop-link').forEach(a=>{
  a.addEventListener('click', ()=> closeDropdown());
});

/* Accessibility: Enter / Space on hamburger */
ham.addEventListener('keydown', e=>{
  if(e.key === 'Enter' || e.key === ' '){
    e.preventDefault();
    ham.click();
  }
});

/* ===========================
   3D STACKED SWIPE (MOBILE)
   =========================== */
if(isMobile){
  setupStackedSwipe();
}

function setupStackedSwipe(){
  const containers = document.querySelectorAll(".cards");
  containers.forEach(container => {
    const cards = Array.from(container.children);
    if(cards.length <= 1) return;

    /* Ensure base styles for mobile stack */
    container.style.position = "relative";
    container.style.perspective = "1200px";

    cards.forEach(card => {
      card.style.position = "absolute";
      card.style.left = "50%";
      card.style.top = "0";
      card.style.transformStyle = "preserve-3d";
    });

    let centerIndex = Math.floor(cards.length / 2);
    let animating = false;

    function updateStack(baseCenter){
      const base = (typeof baseCenter === "number") ? baseCenter : centerIndex;
      let maxHeight = 0;

      cards.forEach((card, i) => {
        const offset = i - base;               // can be fractional during animation
        const absOffset = Math.abs(offset);

        const translateX = offset * 26;        // horizontal spread
        const translateY = absOffset * 8;      // slight drop for depth
        const translateZ = -absOffset * 50;    // push back in Z
        const rotateY   = offset * -9;         // rotate towards user
        const scale     = 1 - absOffset * 0.05;

        const visible = absOffset <= 3.5;

        card.style.zIndex = (cards.length - Math.round(absOffset)).toString();
        card.style.opacity = visible ? "1" : "0";
        card.style.transform =
          "translate(-50%,0) " +
          "translateX(" + translateX + "px) " +
          "translateY(" + translateY + "px) " +
          "translateZ(" + translateZ + "px) " +
          "scale(" + scale + ") " +
          "rotateY(" + rotateY + "deg)";

        const h = card.offsetHeight;
        if(h > maxHeight) maxHeight = h;
      });

      if(maxHeight > 0){
        container.style.height = (maxHeight + 40) + "px";
      }
    }

    updateStack();

    /* Recalculate when images load (so height is correct) */
    cards.forEach(card=>{
      const img = card.querySelector("img");
      if(img){
        img.addEventListener("load", () => {
          updateStack();
        });
      }
    });

    let startX = 0;
    let deltaX = 0;
    let isDragging = false;

    function animateToIndex(targetIndex){
      if(animating) return;
      animating = true;

      const from = centerIndex;
      const to = targetIndex;
      const obj = {p:0};

      gsap.to(obj,{
        p:1,
        duration:0.55,
        ease:"power3.out",
        onUpdate:()=>{
          const currentCenter = from + (to - from) * obj.p;
          updateStack(currentCenter);
        },
        onComplete:()=>{
          centerIndex = to;
          updateStack();
          animating = false;
        }
      });
    }

    function onStart(e){
      if(animating) return;
      if(!e.touches || e.touches.length === 0) return;
      isDragging = true;
      startX = e.touches[0].clientX;
      deltaX = 0;
    }

    function onMove(e){
      if(!isDragging || animating) return;
      if(!e.touches || e.touches.length === 0) return;

      const touch = e.touches[0];
      deltaX = touch.clientX - startX;

      // When horizontal movement is significant → prevent horizontal page pan
      if(Math.abs(deltaX) > 8){
        e.preventDefault();
      }
    }

    function onEnd(){
      if(!isDragging || animating) return;
      isDragging = false;

      const threshold = 50; // swipe sensitivity
      if(Math.abs(deltaX) > threshold){
        if(deltaX < 0 && centerIndex < cards.length - 1){
          // swipe left → move stack forward
          animateToIndex(centerIndex + 1);
        }else if(deltaX > 0 && centerIndex > 0){
          // swipe right → move stack backward
          animateToIndex(centerIndex - 1);
        }
      }

      deltaX = 0;
    }

    container.addEventListener("touchstart", onStart, {passive:true});
    container.addEventListener("touchmove", onMove, {passive:false});
    container.addEventListener("touchend", onEnd, {passive:true});
  });
}
</script>

</body>
</html>
